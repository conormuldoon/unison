

<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>JSDoc: ChartPopup.js</title>

    <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="./build/entry.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://fonts.googleapis.com/css?family=Muli:100,400,700|Oswald:300|Inconsolata,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
    <link type="text/css" rel="stylesheet" href="styles/app.min.css">
    <link type="text/css" rel="stylesheet" href="styles/iframe.css">
</head>

<body>
    <div id="stickyNavbarOverlay"></div>
    <div class="top-navbar">
        <div class="container">
            <nav class="navbar" role="navigation" aria-label="main navigation">
                <div class="navbar-brand">
                    
                     
                        <h1 class="navbar-item">Unison React components</h1>
                    
                    <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                    </a>
                </div>
                
            </nav>
        </div>
    </div>
    <div class="container">
        <div class="columns">
            <div class="column is-3" id="sidebarNav">
                <div class="sidebar">
                    <nav>
                        <h2><a href="index.html">Home</a></h2><div class="category"><h3>Components</h3><ul><li><a href="ARLocationComponent.html">ARLocationComponent</a></li><li><a href="ChartComponent.html">ChartComponent</a></li><li><a href="ChartPopup.html">ChartPopup</a></li><li><a href="DateSelector.html">DateSelector</a></li><li><a href="LeafletMap.html">LeafletMap</a></li><li><a href="LocationForm.html">LocationForm</a></li><li><a href="RemoveForm.html">RemoveForm</a></li><li><a href="TabsComponent.html">TabsComponent</a></li><li><a href="Unison.html">Unison</a></li></ul></div>
                    </nav>
                </div>
            </div>
            <div class="column is-9-desktop">
                <div class="content" id="main-content-wrapper">
                    <header class="page-title">
                        <p>Source</p>
                        <h1>ChartPopup.js</h1>
                    </header>
                    
                    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState, useEffect } from 'react';

import {IoMdClose} from "react-icons/io";

import './App.css';
import TabsComponent from './TabsComponent';
import {varMapping} from './Util';

import {PRECIP,API} from './Constant';

import PropTypes from 'prop-types';

const DLEN=16;

/**
 * A popup that displays a TabsComponent. Once mounted, it connects to the back-end to obtain data
 * for the from date, to date, location, and weather variable selected.
 * 
 * @component
 */
function ChartPopup(props){

  const [data,setData]=useState(undefined);
  const [zoomDomain,setZoomDomain]=useState(undefined);
  const [minMax,setMinMax]=useState(false);

  useEffect(()=>{
    
    async function obtainData(){
      const variRequest=varMapping(props.varCur);

      
      const loc=props.location.trim();
      const request=API+'/'+variRequest+'?location='+loc+"&amp;fromDate="+props.fromDate+"&amp;toDate="+props.toDate;

      let response = await fetch(request);
      let dataArray = await response.json();
    
      const n=dataArray.length;

      for(let i=0;i&lt;n;i++){
        const dateS=dataArray[i].date;
        dataArray[i].date=new Date(dateS.substring(0,DLEN));

      }

      if(n>0){

        const fd=dataArray[0].date;
        const td=dataArray[dataArray.length-1].date;

        if(props.varCur === PRECIP&amp;&amp;dataArray[0].precipitation.minvalue!==undefined){

          setMinMax(true);
        }else{
          setMinMax(false);
        }

        setData(dataArray);
        setZoomDomain({ x: [fd, td] });
      }else{

        setData(undefined);
        setZoomDomain(undefined);
        setMinMax(false);
      }
      
    }
    obtainData();
    

  },[props.varCur,props.location,props.fromDate,props.toDate]);

  function handleClick(e){
    e.stopPropagation();
  }

    // Changing second word in current variable to lower case if present
    let vca=props.varCur.split(' ');
    let vc=vca[0];
    if(vca.length>1){
      vca[1]=vca[1].toLowerCase();
      vc+=' '+vca[1];
    }

    return (
      &lt;div id="popupdiv" data-testid='chart-div' onClick={handleClick}>
        &lt;div id="iicon">
          &lt;IoMdClose onClick={props.closePopup} size={20}  color="rgb(192, 57, 43)" />

        &lt;/div>
        &lt;center>
          {vc} data from {props.location.trim()}

          &lt;TabsComponent varCur={props.varCur} data={data} zoomDomain={zoomDomain} minMax={minMax} 
            setZoomDomain={setZoomDomain}/>

        &lt;/center>
      &lt;/div>
    );

}

ChartPopup.propTypes ={
  /** Specifies the weather variable currently selected. */
  varCur: PropTypes.string,

  /** Sepecifies the location selected. */
  location: PropTypes.string,

  /** Specifies the start date for the data that is to be displayed. */
  fromDate: PropTypes.string,

  /** Specifies the end date for the data that is to be displayed. */
  toDate: PropTypes.string,

  /** Called when the close icon is clicked. */
  closePopup: PropTypes.func,

}

export default ChartPopup;

</code></pre>
        </article>
    </section>




                </div>
            </div>
        </div>
    </div>

<footer class="footer">
    <div class="content has-text-centered">
        <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Wed Oct 16 2019 15:20:12 GMT+0100 (Irish Standard Time)</p>
        <p class="sidebar-created-by">
            <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by 
            <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
        </p>
    </div>
</footer>

<script src="scripts/app.min.js"></script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
